<!DOCTYPE html>
<html>
    <head>
        <style>
        table {
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        </style>
    </head>
    <body style="margin:30px 25px;">
        <h1>Listados de Agentes</h1>
        
            <!-- Datos Personale --> 
            <style type="text/css">
            .tgw  {width: 100%;}
            .tg  {border-collapse:collapse;border-spacing:0;}
            .tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
            .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
            .tg .tg-xq07{background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
            .tg .tg-266k{background-color:#9b9b9b;border-color:inherit;text-align:left;vertical-align:top}
            .tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
            .tg .tg-tf2e{text-align:left;vertical-align:top}
            .m0{margin: 0px}
            .bold {font-weight:bold}
            </style>
            <%- include("../utils/print") %>
            <% for (const grupo of gruposAgente) { %>
            <table class="tg tgw" style="width:100%">
                <tr> <!-- HEADER  -->
                    <th class="tg-266k" colspan="5">
                        <h2 class="m0">Agrupamiento: <%= value(grupo._id) %></h2>
                    </th>
                </tr>
                
                <tr> 
                    <td class="tg-xq07" style="width:10%"><h3 class="m0">Numero</h3></td>
                    <td class="tg-xq07" style="width:10%"><h3 class="m0">Documento</h3></td>
                    <td class="tg-xq07" style="width:40%"><h3 class="m0">Nombre</h3></td>
                    <td class="tg-xq07" style="width:20%"><h3 class="m0">Lugar de Trabajo</h3></td>
                    <td class="tg-xq07" style="width:20%"><h3 class="m0">Servicio</h3></td>
                </tr>
                <% for (const agente of grupo.agentes) { %>
                   
                    <tr>
                        <td class="tg-0pky"><%= value(agente.numero) %></td>
                        <td class="tg-0pky"><%= value(agente.documento) %></td>
                        <td class="tg-0pky"><%= value(agente.apellido) %>, <%= value(agente.nombre) %></td>
                        <td class="tg-0pky"><%= value(agente, 'situacionLaboral.cargo.sector.nombre') %> </td>
                        <td class="tg-0pky"><%= value(agente, 'situacionLaboral.cargo.servicio.nombre') %></td>
                    </tr>
                    <% for (const field of extraFields) { %>
                        <tr>
                            <td class="tg-0pky" colspan="5"><%= label(field) %>: <%= value(agente, field) %></td>
                        </tr>
                    <% } %>
                <% } %>
            </table>
            <br>
        <% } %>
    </body>
</html>