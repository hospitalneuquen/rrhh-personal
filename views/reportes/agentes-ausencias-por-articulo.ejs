<!DOCTYPE html>
<html>
    <head>
        <style>
        table {
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        </style>
    </head>
    <body style="margin:30px 25px;">
        <h1>Ausencias. Totales por Articulo</h1>
        <style type="text/css">
            .tgw  {width: 100%;}
            .tg  {border-collapse:collapse;border-spacing:0;}
            .tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
            .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
            .tg .tg-xq07{background-color:#efefef;border-color:inherit;text-align:left;vertical-align:top}
            .tg .tg-266k{background-color:#9b9b9b;border-color:inherit;text-align:left;vertical-align:top}
            .tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
            .tg .tg-tf2e{text-align:left;vertical-align:top}
            .m0{margin: 0px}
            .bold {font-weight:bold}
            </style>
            <%- include("../utils/print") %>
            <% for (const grupo of gruposAgente) { %>
            <table class="tg tgw">
                <!-- HEADER  -->
                <tr> 
                    <th class="tg-266k" colspan="<%= articulos.length + 4 %>">
                        <h2 class="m0">Agrupamiento: <%= value(grupo._id) %></h2>
                    </th>
                </tr>
                <!-- SUBHEADER  -->
                <tr> 
                    <td class="tg-xq07" rowspan="2"><h3 class="m0">Identificacion</h3></td>
                    <td class="tg-xq07" rowspan="2"><h3 class="m0">Apellido y Nombre</h3></td>
                    <td class="tg-xq07" colspan="<%= articulos.length %>"><h3 class="m0">Articulos</h3></td>
                    <td class="tg-xq07" rowspan="2"><h3 class="m0">Total</h3></td>
                </tr>
                <tr> 
                    <% for (const articulo of articulos) { %>
                        <td class="tg-xq07"><h3 class="m0"><%= value(articulo.codigo) %></h3></td>
                    <% } %>
                </tr>
                <!-- DATA  -->
                <% let ceroRows = '' %>
                <% for (index = 0; index <= articulos.length + 1; index++){ ceroRows = ceroRows + "<td class='tg-0pky'>0</td>" } %>
                    
                <% for (const agente of grupo.agentes) { %>
                    <tr>
                        <td class="tg-0pky">Agente <%= value(agente.numero) %>. DNI <%= value(agente.documento) %></td>
                        <td class="tg-0pky"><%= value(agente.apellido) %>, <%= value(agente.nombre) %></td>
                        <% if (agente.ausentismo.length) { %>
                            <% let articulosMap = mapTotalesPorArticulos(articulos, agente.ausentismo[0].articulos) %>
                            <% for (const articulo of articulosMap) {  %>
                                <td class="tg-0pky"><%= articulo.ausencias %></td>
                            <% } %>    
                            <td class="tg-0pky"><%= agente.ausentismo[0].ausenciasTotales %></td>
                        <% } else { %>  
                            <%- ceroRows %>
                        <% } %>        
                    </tr>
                <% } %>
                
            </table>
            <br>
        <% } %>

    </body>
</html>